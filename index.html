<!DOCTYPE html>
<html>
<head>
  <title>Puzzle GÃ©ographique avec Guides</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      text-align: center;
      background: #f0f8ff;
      padding: 20px;
    }
    h1 {
      color: #2c3e50;
      margin-bottom: 10px;
    }
    #map-container {
      position: relative;
      display: inline-block;
    }
    #map {
      background: url('https://upload.wikimedia.org/wikipedia/commons/7/73/Europe_blank_map.png');
      background-size: cover;
      width: 800px;
      height: 600px;
      border: 3px solid #34495e;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }
    .piece {
      width: 120px;
      position: absolute;
      cursor: grab;
      border: 3px dashed transparent;
      transition: transform 0.2s;
      border-radius: 5px;
      z-index: 10;
    }
    .piece:hover {
      transform: scale(1.05);
    }
    .correct {
      border: 3px solid #27ae60 !important;
      box-shadow: 0 0 10px #2ecc71;
      cursor: default !important;
    }
    .outline {
      position: absolute;
      width: 120px;
      opacity: 0.5;
      pointer-events: none;
      z-index: 5;
      border-radius: 5px;
    }
    #score {
      font-size: 24px;
      font-weight: bold;
      color: #e74c3c;
      margin: 15px;
    }
    #message {
      font-size: 20px;
      height: 30px;
      color: #3498db;
      margin-bottom: 10px;
    }
    #controls {
      margin: 20px;
    }
    button {
      background: #3498db;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
      margin: 0 10px;
    }
    button:hover {
      background: #2980b9;
    }
  </style>
</head>
<body>
  <h1>Puzzle GÃ©ographique</h1>
  <div id="message">Place les drapeaux sur les zones ombrÃ©es !</div>
  <div id="score">Pays corrects : 0/3</div>
  
  <div id="controls">
    <button id="hint">Montrer les zones</button>
    <button id="reset">RÃ©initialiser</button>
  </div>

  <div id="map-container">
    <!-- Carte de base -->
    <div id="map"></div>
    
    <!-- Contours des pays (guides) -->
    <img src="https://i.imgur.com/JQK6hXz.png" class="outline" id="france-outline" style="left: 280px; top: 240px;">
    <img src="https://i.imgur.com/VW7lQ9E.png" class="outline" id="spain-outline" style="left: 220px; top: 320px;">
    <img src="https://i.imgur.com/9Rk4T2w.png" class="outline" id="italy-outline" style="left: 340px; top: 300px;">
    
    <!-- Drapeaux Ã  placer -->
    <img src="https://flagcdn.com/w160/fr.png" class="piece" id="france">
    <img src="https://flagcdn.com/w160/es.png" class="piece" id="spain">
    <img src="https://flagcdn.com/w160/it.png" class="piece" id="italy">
  </div>

  <script>
    // Positions correctes (x, y)
    const correctPositions = {
      france: { x: 280, y: 240 },
      spain:  { x: 220, y: 320 },
      italy:  { x: 340, y: 300 }
    };

    let score = 0;
    const totalCountries = 3;
    let outlinesVisible = false;

    // Initialisation
    document.addEventListener('DOMContentLoaded', () => {
      initPieces();
      initControls();
    });

    function initPieces() {
      const pieces = document.querySelectorAll('.piece');
      
      // Position alÃ©atoire au dÃ©part
      pieces.forEach(piece => {
        piece.style.left = `${Math.random() * 500 + 50}px`;
        piece.style.top = `${Math.random() * 300 + 50}px`;
        piece.addEventListener('mousedown', startDrag);
      });
      
      // Cache les contours par dÃ©faut
      toggleOutlines(false);
    }

    function initControls() {
      // Bouton indice
      document.getElementById('hint').addEventListener('click', () => {
        outlinesVisible = !outlinesVisible;
        toggleOutlines(outlinesVisible);
      });
      
      // Bouton reset
      document.getElementById('reset').addEventListener('click', () => {
        document.querySelectorAll('.piece').forEach(piece => {
          piece.style.left = `${Math.random() * 500 + 50}px`;
          piece.style.top = `${Math.random() * 300 + 50}px`;
          piece.classList.remove('correct');
          piece.style.cursor = 'grab';
        });
        score = 0;
        document.getElementById('score').textContent = `Pays corrects : ${score}/${totalCountries}`;
        document.getElementById('message').textContent = 'Place les drapeaux sur les zones ombrÃ©es !';
        document.getElementById('message').style.color = '#3498db';
        toggleOutlines(false);
      });
    }

    function toggleOutlines(show) {
      document.querySelectorAll('.outline').forEach(outline => {
        outline.style.opacity = show ? '0.5' : '0';
      });
      document.getElementById('hint').textContent = show ? 'Cacher les zones' : 'Montrer les zones';
    }

    function startDrag(e) {
      if (e.target.classList.contains('correct')) return;
      
      e.preventDefault();
      const piece = e.target;
      piece.style.cursor = 'grabbing';

      const startX = e.clientX;
      const startY = e.clientY;
      const startLeft = parseInt(piece.style.left) || 0;
      const startTop = parseInt(piece.style.top) || 0;

      function move(e) {
        piece.style.left = `${startLeft + e.clientX - startX}px`;
        piece.style.top = `${startTop + e.clientY - startY}px`;
      }

      function stopDrag() {
        document.removeEventListener('mousemove', move);
        document.removeEventListener('mouseup', stopDrag);
        piece.style.cursor = 'grab';
        checkPosition(piece);
      }

      document.addEventListener('mousemove', move);
      document.addEventListener('mouseup', stopDrag);
    }

    function checkPosition(piece) {
      if (piece.classList.contains('correct')) return;
      
      const id = piece.id;
      const currentX = parseInt(piece.style.left);
      const currentY = parseInt(piece.style.top);
      const correct = correctPositions[id];

      if (Math.abs(currentX - correct.x) < 30 && Math.abs(currentY - correct.y) < 30) {
        // Position correcte
        piece.style.left = `${correct.x}px`;
        piece.style.top = `${correct.y}px`;
        piece.classList.add('correct');
        piece.style.cursor = 'default';
        
        score++;
        document.getElementById('score').textContent = `Pays corrects : ${score}/${totalCountries}`;
        document.getElementById('message').textContent = `Bravo pour ${id.toUpperCase()} !`;
        document.getElementById('message').style.color = '#27ae60';
        setTimeout(() => {
          if (score < totalCountries) {
            document.getElementById('message').textContent = 'Continue !';
          }
        }, 2000);
        
        // VÃ©rifie si tout est complet
        if (score === totalCountries) {
          setTimeout(() => {
            document.getElementById('message').textContent = 'ðŸŽ‰ FÃ©licitations ! Vous avez gagnÃ© !';
            document.getElementById('message').style.color = '#e67e22';
          }, 500);
        }
      }
    }
  </script>
</body>
</html>
